webpackJsonp([2],{J77n:function(e,t){},OZmL:function(e,t,a){"use strict";var s=a("Dd8w"),n=a.n(s),o=a("hQg6"),i=a.n(o),r=a("ZxXG"),c=a("NYxO"),l={props:{data:{type:Object,required:!0}},data:function(){return{defaultAvatar:"",isFollowed:void 0}},computed:n()({},Object(c.e)(["authUserInfo","totalFollows"]),{checkIsSameStyle:function(){return this.authUserInfo.id===this.data._id?{visibility:"hidden"}:{}}}),methods:n()({},Object(c.d)(["SET_FOLLOWS"]),{goFollow:function(){var e=this,t=new r.a;this.isFollowed?this.$confirm("确定要对他取消关注吗？",{type:"warning",lockScroll:!1}).then(function(){t.follow(e.data._id,"cancel").then(function(){e.isFollowed=!1,e.SET_FOLLOWS(e.totalFollows-1)})}).catch(function(){}):t.follow(this.data._id,"follow").then(function(){e.isFollowed=!0,e.SET_FOLLOWS(e.totalFollows+1)})}}),created:function(){this.defaultAvatar=i.a,this.isFollowed=this.data.hasFollowed}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mini-user"},[a("div",{staticClass:"avatar-box"},[a("img",{staticClass:"avatar",attrs:{src:e.data.avatar||e.defaultAvatar}})]),e._v(" "),a("div",{staticClass:"content"},[a("h3",[a("router-link",{attrs:{to:"/user?id="+e.data._id}},[e._v(e._s(e.data.nickname))])],1),e._v(" "),a("h4",[e._v("简介："+e._s(e.data.desc||"这个人很懒什么都不写"))]),e._v(" "),a("el-button",{staticClass:"follow-btn",style:e.checkIsSameStyle,attrs:{size:"mini",icon:e.isFollowed?"":"el-icon-plus",type:e.isFollowed?"default":"primary"},on:{click:e.goFollow}},[e._v(e._s(e.isFollowed?"已关注":"关注"))])],1)])},staticRenderFns:[]};var u=a("VU/8")(l,d,!1,function(e){a("J77n")},"data-v-19ce18ee",null);t.a=u.exports},XsKc:function(e,t){},ZtLn:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Xxa5"),n=a.n(s),o=a("exGp"),i=a.n(o),r=a("Dd8w"),c=a.n(r),l=a("0HiU"),d=a("OZmL"),u=a("YMNS"),h=a("ZxXG"),m=a("NYxO"),v={name:"Search",components:{Moment:l.a,MiniUser:d.a,ClickMore:u.a},data:function(){return{keyword:"",navFlag:"moments",moments:[],users:[],searchLoading:!0,searchComplete:!1,page:1,size:15}},methods:c()({},Object(m.d)(["HIDE_HEADER"]),{handleSelect:function(e){this.navFlag=e,this.goSearch()},goSearch:function(){this.moments=[],this.users=[],this.page=1,this.searchComplete=!1,this.loadSearchResult()},loadSearchResult:function(){var e=this;return i()(n.a.mark(function t(){var a,s;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.searchComplete){t.next=2;break}return t.abrupt("return");case 2:if(a=new h.a,s=void 0,e.searchLoading=!0,"moments"!==e.navFlag){t.next=12;break}return t.next=8,a.searchMoment(e.keyword,e.page,e.size);case 8:s=t.sent,e.moments=e.moments.concat(s.data.data),t.next=17;break;case 12:if("users"!==e.navFlag){t.next=17;break}return t.next=15,a.searchUser(e.keyword,e.page,e.size);case 15:s=t.sent,e.users=e.users.concat(s.data.data);case 17:++e.page,e.searchLoading=!1,s.data.data.length<e.size&&(e.searchComplete=!0);case 20:case"end":return t.stop()}},t,e)}))()}}),mounted:function(){this.loadSearchResult()},created:function(){this.HIDE_HEADER(!1),this.keyword=this.$route.query.kw||""}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"social-search"},[a("div",{staticClass:"wrapper-top"},[a("div",{staticClass:"input-box"},[a("el-input",{staticClass:"inputBox",attrs:{placeholder:"搜索","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.goSearch(t)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),e._v(" "),a("el-button",{staticClass:"search-btn",attrs:{type:"primary",size:"mini"},on:{click:e.goSearch}},[e._v("搜索")])],1),e._v(" "),a("div",{staticClass:"nav-bar"},[a("el-menu",{staticClass:"menu",attrs:{"default-active":e.navFlag,"active-text-color":"#409eff",mode:"horizontal"},on:{select:e.handleSelect}},[a("el-menu-item",{attrs:{index:"moments"}},[e._v("找动态")]),e._v(" "),a("el-menu-item",{attrs:{index:"users"}},[e._v("找用户")])],1)],1)]),e._v(" "),a("div",{staticClass:"wrapper-body"},[a("ClickMore",{attrs:{loading:e.searchLoading,completed:e.searchComplete}},["moments"===e.navFlag?e._l(e.moments,function(e){return a("moment",{key:e._id,attrs:{data:e,hideDeleteBtn:!0}})}):e._e(),e._v(" "),"users"===e.navFlag?e._l(e.users,function(e){return a("mini-user",{key:e._id,staticClass:"user-card",attrs:{data:e}})}):e._e()],2)],1)])},staticRenderFns:[]};var p=a("VU/8")(v,f,!1,function(e){a("XsKc")},"data-v-57a0cece",null);t.default=p.exports}});