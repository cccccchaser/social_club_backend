webpackJsonp([3],{J77n:function(t,e){},JCQj:function(t,e){},OZmL:function(t,e,a){"use strict";var s=a("Dd8w"),n=a.n(s),o=a("hQg6"),l=a.n(o),i=a("ZxXG"),r=a("NYxO"),c={props:{data:{type:Object,required:!0}},data:function(){return{defaultAvatar:"",isFollowed:void 0}},computed:n()({},Object(r.e)(["authUserInfo","totalFollows"]),{checkIsSameStyle:function(){return this.authUserInfo.id===this.data._id?{visibility:"hidden"}:{}}}),methods:n()({},Object(r.d)(["SET_FOLLOWS"]),{goFollow:function(){var t=this,e=new i.a;this.isFollowed?this.$confirm("确定要对他取消关注吗？",{type:"warning",lockScroll:!1}).then(function(){e.follow(t.data._id,"cancel").then(function(){t.isFollowed=!1,t.SET_FOLLOWS(t.totalFollows-1)})}).catch(function(){}):e.follow(this.data._id,"follow").then(function(){t.isFollowed=!0,t.SET_FOLLOWS(t.totalFollows+1)})}}),created:function(){this.defaultAvatar=l.a,this.isFollowed=this.data.hasFollowed}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mini-user"},[a("div",{staticClass:"avatar-box"},[a("img",{staticClass:"avatar",attrs:{src:t.data.avatar||t.defaultAvatar}})]),t._v(" "),a("div",{staticClass:"content"},[a("h3",[a("router-link",{attrs:{to:"/user?id="+t.data._id}},[t._v(t._s(t.data.nickname))])],1),t._v(" "),a("h4",[t._v("简介："+t._s(t.data.desc||"这个人很懒什么都不写"))]),t._v(" "),a("el-button",{staticClass:"follow-btn",style:t.checkIsSameStyle,attrs:{size:"mini",icon:t.isFollowed?"":"el-icon-plus",type:t.isFollowed?"default":"primary"},on:{click:t.goFollow}},[t._v(t._s(t.isFollowed?"已关注":"关注"))])],1)])},staticRenderFns:[]};var u=a("VU/8")(c,d,!1,function(t){a("J77n")},"data-v-19ce18ee",null);e.a=u.exports},x7Nh:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Xxa5"),n=a.n(s),o=a("exGp"),l=a.n(o),i=a("Dd8w"),r=a.n(i),c=a("0HiU"),d=a("OZmL"),u=a("YMNS"),m=a("AJBx"),h=a("ZxXG"),f=a("90m7"),v=a("hQg6"),_=a.n(v),w=a("NYxO"),p={mixins:[f.a],components:{Moment:c.a,MiniUser:d.a,ClickMore:u.a,Loading:m.a},data:function(){return{defaultAvatar:"",navFlag:"",moments:[],users:[],userId:"",nickname:"",avatar:"",desc:"",sex:void 0,fans_num:void 0,follows_num:void 0,moments_num:void 0,hasFollowed:void 0,page:1,size:15,completed:!1,loadingResult:!0}},computed:r()({},Object(w.e)(["authUserInfo","totalFollows","totalFans","totalMoments"])),methods:r()({},Object(w.d)(["HIDE_HEADER","SET_FOLLOWS","SET_MOMENTS"]),{handleEdit:function(){this.$router.push("/user/edit")},clearInfoData:function(){this.avatar="",this.nickname="",this.desc="",this.sex=void 0,this.moments_num=0,this.follows_num=0,this.fans_num=0},clearLoadedData:function(){this.page=1,this.completed=!1,this.moments=[],this.users=[]},handleSelect:function(t){this.navFlag=t,this.clearLoadedData(),this.loadResults()},deleteMoment:function(t,e){var a=this,s=this;(new h.a).deleteMoment(t).then(function(){s.SET_MOMENTS(a.totalMoments-1),s.moments.splice(e,1),s.$message({message:"删除成功",type:"success"})})},toggleFollow:function(){var t=this,e=function(e){(new h.a).follow(t.userId,e).then(function(){t.hasFollowed="follow"===e,t.SET_FOLLOWS("cancel"===e?t.totalFollows-1:t.totalFollows+1)})};this.hasFollowed?this.$confirm("你确定要取消此用户吗",{lockScroll:!1,type:"warning"}).then(function(){e("cancel")}).catch():e("follow")},loadResults:function(){var t=this;return l()(n.a.mark(function e(){var a,s,o,l,i,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.completed){e.next=2;break}return e.abrupt("return");case 2:if(t.loadingResult=!0,a=new h.a,s=[],"totalMoments"!==t.navFlag){e.next=13;break}return e.next=8,a.getMoment("targetMoments",t.page,t.size,t.userId);case 8:o=e.sent,s=o.data.data,t.moments=t.moments.concat(s),e.next=35;break;case 13:if("likeMoments"!==t.navFlag){e.next=21;break}return e.next=16,a.getMoment("likeMoments",t.page,t.size,t.userId);case 16:l=e.sent,s=l.data.data,t.moments=t.moments.concat(s),e.next=35;break;case 21:if("follows"!==t.navFlag){e.next=29;break}return e.next=24,a.getUserFollows(t.userId,t.page,t.size);case 24:i=e.sent,s=i.data.data,t.users=t.users.concat(s),e.next=35;break;case 29:if("fans"!==t.navFlag){e.next=35;break}return e.next=32,a.getUserFans(t.userId,t.page,t.size);case 32:r=e.sent,s=r.data.data,t.users=t.users.concat(s);case 35:t.page++,t.loadingResult=!1,s.length<t.size&&(t.completed=!0);case 38:case"end":return e.stop()}},e,t)}))()},initUserInfo:function(){var t=this;this.userId===this.authUserInfo.id?(this.avatar=this.authUserInfo.avatar,this.nickname=this.authUserInfo.nickname,this.desc=this.authUserInfo.desc,this.sex=this.authUserInfo.sex,this.moments_num=this.totalMoments,this.follows_num=this.totalFollows,this.fans_num=this.totalFans):(new h.a).getUserInfo(this.userId).then(function(e){var a=e.data.data;t.avatar=a.avatar,t.nickname=a.nickname,t.desc=a.desc,t.sex=a.sex,t.moments_num=a.moments_num,t.follows_num=a.follows_num,t.fans_num=a.fans_num,t.hasFollowed=a.hasFollowed})}}),mounted:function(){var t=this;this.initUserInfo(),this.loadResults(),this.$watch("$route.query.id",function(e){t.navFlag="totalMoments",t.userId=e||t.authUserInfo.id,t.clearInfoData(),t.clearLoadedData(),t.initUserInfo(),t.loadResults()})},created:function(){var t=this.$route.query,e=t.id,a=t.navFlag;this.userId=e||this.authUserInfo.id,this.navFlag=a||"totalMoments",this.defaultAvatar=_.a,this.HIDE_HEADER(!1)}},F={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"social-user"},[a("div",{staticClass:"user-header"},[a("div",{staticClass:"avatar-box"},[a("img",{staticClass:"avatar",attrs:{src:t.avatar||t.defaultAvatar}})]),t._v(" "),t.userId!==t.authUserInfo.id?a("el-button",{staticClass:"follow-btn",attrs:{size:"mini",type:t.hasFollowed?"":"primary",icon:t.hasFollowed?"":"el-icon-plus",plain:t.hasFollowed},on:{click:t.toggleFollow}},[t._v(t._s(t.hasFollowed?"已关注":"关注"))]):a("el-button",{staticClass:"edit-btn",attrs:{icon:"el-icon-edit-outline",size:"mini",plain:""},on:{click:t.handleEdit}},[t._v("编辑")]),t._v(" "),a("h1",{staticClass:"name"},[t._v("\n      "+t._s(t.nickname)+"\n      "),t.sex?a("i",{staticClass:"fa",class:1===t.sex?"fa-mars":"fa-venus"}):t._e()]),t._v(" "),a("ul",{staticClass:"info-panel"},[a("li",{on:{click:function(e){return t.handleSelect("follows")}}},[a("span",{staticClass:"number"},[t._v(t._s(t.follows_num))]),t._v(" "),a("span",{staticClass:"label"},[t._v("关注")])]),t._v(" "),a("li",{on:{click:function(e){return t.handleSelect("fans")}}},[a("span",{staticClass:"number"},[t._v(t._s(t.fans_num))]),t._v(" "),a("span",{staticClass:"label"},[t._v("粉丝")])]),t._v(" "),a("li",{on:{click:function(e){return t.handleSelect("totalMoments")}}},[a("span",{staticClass:"number"},[t._v(t._s(t.moments_num))]),t._v(" "),a("span",{staticClass:"label"},[t._v("动态")])])]),t._v(" "),a("h3",{staticClass:"desc"},[t._v("简介："+t._s(t.desc||"这家伙很懒，什么都不写"))])],1),t._v(" "),a("div",{staticClass:"nav-bar"},[a("el-menu",{staticClass:"menu",attrs:{"default-active":t.navFlag,"active-text-color":"#409eff",mode:"horizontal"},on:{select:t.handleSelect}},[a("el-menu-item",{attrs:{index:"totalMoments"}},[t._v("所有动态")]),t._v(" "),a("el-menu-item",{attrs:{index:"likeMoments"}},[t._v("赞的动态")]),t._v(" "),a("el-menu-item",{attrs:{index:"follows"}},[t._v("关注的人")]),t._v(" "),a("el-menu-item",{attrs:{index:"fans"}},[t._v("全部粉丝")])],1)],1),t._v(" "),a("div",{staticClass:"result-wrapper"},[a("Loading",{attrs:{loading:t.loadingResult},on:{"update:loading":function(e){t.loadingResult=e}}}),t._v(" "),a("ClickMore",{attrs:{loading:t.loadingResult,completed:t.completed},on:{loadMore:t.loadResults}},[["totalMoments","likeMoments"].includes(t.navFlag)&&t.moments.length?t._l(t.moments,function(e,s){return a("moment",{key:e._id,attrs:{data:e,hideFollowBtn:!0},on:{delete:function(a){return t.deleteMoment(e._id,s)}}})}):t._l(t.users,function(t){return a("mini-user",{key:t._id,staticClass:"user-card",attrs:{data:t}})})],2)],1)])},staticRenderFns:[]};var g=a("VU/8")(p,F,!1,function(t){a("JCQj")},"data-v-02c59470",null);e.default=g.exports}});